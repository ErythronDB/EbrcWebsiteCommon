#!/bin/bash

sites=(
  https://veupathdb.org
  https://amoebadb.org
  https://cryptodb.org
  https://fungidb.org
  https://giardiadb.org
  https://hostdb.org
  https://microsporidiadb.org
  https://piroplasmadb.org
  https://plasmodb.org
  https://schistodb.net
  https://toxodb.org
  https://trichdb.org
  https://tritrypdb.org
  https://vectorbase.org
  https://orthomcl.org
  https://clinepidb.org
  https://microbiomedb.org
)

if [ $# -ne 2 ]; then
  echo
  echo "USAGE: eupathInvalidPublicStratsReport <auth_code> <query_string>"
  echo
  echo "  auth_code = 'user_email|password' of an admin user"
  echo "  query_string = query string to pass to the service (do not include '?')"
  echo
  echo "    Query string options (all default to false if omitted)"
  echo "      notifyUsers:     notification emails will be sent to strategy owners"
  echo "      logEmailContent: email content will be logged (wdk.log4j)"
  echo "      statsOnly:       strategy details will not be included in response"
  echo
  exit 1
fi

authCode=$1
queryString=$2

for site in "${sites[@]}"; do
  url="$site/a/service/invalid-public-strats-report?$queryString"
  echo "##############################################"
  echo "$site"
  echo "##############################################"
  curl -H "auth-code: $authCode" -X GET $url
  echo
done
